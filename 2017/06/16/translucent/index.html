<!DOCTYPE html>
<html lang="zh">
    <head>
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.3.4 -->

    <!-- Title -->
    
    <title>
        
            app中的沉浸式 | 
        
        我的博客
    </title>

    <!-- Meta & Info -->
    <meta charset="utf-8">

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">
    
    
    
    
    
    

    <meta http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#0097A7">
    <meta name="author" content="孙俊卿">
    <meta name="description" content="记录生活点滴">
    <meta name="keywords" content="java">

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" sizes="192x192" href="/img/favicon.png">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!--iOS -->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="Title">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="我的博客">

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://livesun.github.io">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="app中的沉浸式 | 我的博客">
    <meta property="og:description" content="记录生活点滴">
    

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import CSS & jQuery -->
    
        <link rel="stylesheet" href="/css/material.min.css">
        <link rel="stylesheet" href="/css/style.min.css">
        <!-- Config CSS -->


<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-image: url(/img/bg.png);
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


        <script src="/js/jquery.min.js"></script>
        <script src="/js/queue.js"></script>
    

    <!-- UC Browser Compatible -->
    <script>
        var agent = navigator.userAgent.toLowerCase();
        if(agent.indexOf('ucbrowser')>0) {
            document.write("<link rel=\"stylesheet\" href=\"/css/uc.css\">");
            alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
        }
    </script>

    

    


    <!-- Bing Background -->
    

    <!-- Custom Head -->
    
<link rel="stylesheet" href="/css/prism-okaidia.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->

    <!-- Left aligned menu below button -->
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#app中的沉浸式"><span class="post-toc-number">1.</span> <span class="post-toc-text">app中的沉浸式</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#而我们一般所说的沉浸式是顶部状态栏和标题栏颜色一致，或者为一张图片。"><span class="post-toc-number">2.</span> <span class="post-toc-text">而我们一般所说的沉浸式是顶部状态栏和标题栏颜色一致，或者为一张图片。</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#5-0-版本的实现方式"><span class="post-toc-number">3.</span> <span class="post-toc-text">5.0+版本的实现方式</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#一、状态栏"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">一、状态栏</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#二、底部导航栏"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">二、底部导航栏</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#4-4-版本"><span class="post-toc-number">4.</span> <span class="post-toc-text">4.4+版本</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#首先，状态栏，我们可以分别在属性样式和代码中进行设置。"><span class="post-toc-number"></span> <span class="post-toc-text">首先，状态栏，我们可以分别在属性样式和代码中进行设置。</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决方法一："><span class="post-toc-number">0.1.</span> <span class="post-toc-text">解决方法一：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决方法二："><span class="post-toc-number">0.2.</span> <span class="post-toc-text">解决方法二：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#通过反射"><span class="post-toc-number">0.3.</span> <span class="post-toc-text">通过反射</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#通过getResources-getIdentifier"><span class="post-toc-number">0.4.</span> <span class="post-toc-text">通过getResources.getIdentifier()</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#接着，4-4版本的导航条"><span class="post-toc-number"></span> <span class="post-toc-text">接着，4.4版本的导航条</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#反射"><span class="post-toc-number">0.1.</span> <span class="post-toc-text">反射</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#getResources-getIdentifier"><span class="post-toc-number">0.2.</span> <span class="post-toc-text">getResources.getIdentifier()</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#比较凌乱的代码分享"><span class="post-toc-number"></span> <span class="post-toc-text">比较凌乱的代码分享:</span></a>

        <!--
        <li class="mdl-menu__item">
            Some Action
        </li>
        -->
    </ul>




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script>
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                app中的沉浸式
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>孙俊卿</strong>
        <span>6月 16, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        
    </ul>
    

    <!-- Share -->
    <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=app中的沉浸式&url=http://livesun.github.io//2017/06/16/translucent/index.html&pic=&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=app中的沉浸式&url=http://livesun.github.io//2017/06/16/translucent/index.html&via=孙俊卿" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://livesun.github.io//2017/06/16/translucent/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://livesun.github.io//2017/06/16/translucent/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=我的博客&title=app中的沉浸式&summary=记录生活点滴&pics=http://livesun.github.io/img/favicon.png&url=http://livesun.github.io/2017/06/16/translucent/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h3 id="app中的沉浸式"><a href="#app中的沉浸式" class="headerlink" title="app中的沉浸式"></a>app中的沉浸式</h3><p>官方的沉浸式的含义是指，APP沉浸(充斥了整个屏幕)在屏幕里面，没有显示状态栏，甚至没有显示底部导航栏。</p>
<p>如：</p>
<ul>
<li>全屏状态下的视频播放器</li>
<li>全屏状态下的阅读器</li>
</ul>
<p>类似这样：</p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_full_notitle.jpg" alt="image"></p>
<h3 id="而我们一般所说的沉浸式是顶部状态栏和标题栏颜色一致，或者为一张图片。"><a href="#而我们一般所说的沉浸式是顶部状态栏和标题栏颜色一致，或者为一张图片。" class="headerlink" title="而我们一般所说的沉浸式是顶部状态栏和标题栏颜色一致，或者为一张图片。"></a>而我们一般所说的沉浸式是顶部状态栏和标题栏颜色一致，或者为一张图片。</h3><ul>
<li>状态栏为图片延伸（4.4版本效果）</li>
</ul>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_full.png" alt="image"></p>
<ul>
<li>状态栏为纯颜色（4.4版本效果）</li>
</ul>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_one.png" alt="image"></p>
<ul>
<li>导航栏和状态栏颜色一致（4.4版本效果）</li>
</ul>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_two.png" alt="image"><br>支持版本：</p>
<ul>
<li>5.0+版本</li>
<li>4.4以上版本</li>
</ul>
<p>4.4以下版本是无法做到沉浸式，除非修改底层。</p>
<h3 id="5-0-版本的实现方式"><a href="#5-0-版本的实现方式" class="headerlink" title="5.0+版本的实现方式"></a>5.0+版本的实现方式</h3><blockquote>
<p>5.0+可以自动实现了沉浸式效果，状态栏的颜色跟随你的主题里面的colorPrimaryDark属性，相对来说非常简单，我们这里有三种方法：</p>
</blockquote>
<p>在此之前，我们需要把样式设为NoActionBar</p>
<pre><code>    &lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;

        &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;
        &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;
        &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;
    &lt;/style&gt;
</code></pre><h4 id="一、状态栏"><a href="#一、状态栏" class="headerlink" title="一、状态栏"></a>一、状态栏</h4><p>1、设置style 文件中 colorPrimary 和 colorPrimaryDark的颜色值一样</p>
<pre><code> &lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;
        &lt;!-- Customize your theme here. --&gt;
        &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;
        &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimary&lt;/item&gt;
        &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;

    &lt;/style&gt;
</code></pre><p>2、设置style 文件中 属性样式 android:statusBarColor 的颜色值</p>
<pre><code>&lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;
        &lt;!-- Customize your theme here. --&gt;
        &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;
        &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;
        &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;
       &lt;item name=&quot;android:statusBarColor&quot;&gt;@color/colorAccent&lt;/item&gt;
    &lt;/style&gt;
</code></pre><p>3、通过代码设置，在setContentView之 后。getWindow().setStatusBarColor();</p>
<pre><code>protected void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        getWindow().setNavigationBarColor(Color.GREEN);

    }
</code></pre><p>4、如果像设置图片在状态栏中</p>
<pre><code> View decorView = getWindow().getDecorView();
 int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN| View.SYSTEM_UI_FLAG_LAYOUT_STABLE;
 decorView.setSystemUiVisibility(option);

 //并且，需要动态计算statusbar的高度，设置进去。
 这里下面再讲
</code></pre><h4 id="二、底部导航栏"><a href="#二、底部导航栏" class="headerlink" title="二、底部导航栏"></a>二、底部导航栏</h4><p>1、在属性文件中，设置android:navigationBarColor的颜色值。</p>
<pre><code>&lt;style name=&quot;AppTheme&quot; parent=&quot;Theme.AppCompat.Light.NoActionBar&quot;&gt;
        &lt;!-- Customize your theme here. --&gt;
        &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;
        &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;
        &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;
       &lt;item name=&quot;android:navigationBarColor&quot;&gt;@color/colorAccent&lt;/item&gt;
    &lt;/style&gt;
</code></pre><p>2、通过代码设置，同样是在setContentView之后</p>
<pre><code> getWindow().setNavigationBarColor(int color);
</code></pre><p>5.0以上，都有专门提供的api,所以没什么难度，大家看看就行，选一种自己觉得方便的方法就行，我们着重讲一下，如何兼容4.4版本。</p>
<h3 id="4-4-版本"><a href="#4-4-版本" class="headerlink" title="4.4+版本"></a>4.4+版本</h3><h2 id="首先，状态栏，我们可以分别在属性样式和代码中进行设置。"><a href="#首先，状态栏，我们可以分别在属性样式和代码中进行设置。" class="headerlink" title="首先，状态栏，我们可以分别在属性样式和代码中进行设置。"></a>首先，状态栏，我们可以分别在属性样式和代码中进行设置。</h2><p>1、在属性样式里（不推荐，需要建values-v19）</p>
<pre><code>&lt;item name=&quot;android:windowTranslucentStatus&quot;&gt;true&lt;/item&gt;
</code></pre><p>2、在代码中</p>
<p>记住在 <strong>setContentView</strong> 之前设置。</p>
<pre><code>getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);

setContentView(R.layout.activity_main);
</code></pre><p>然后发现会出现了副作用。</p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_title_no.png" alt="image"></p>
<h4 id="解决方法一："><a href="#解决方法一：" class="headerlink" title="解决方法一："></a>解决方法一：</h4><p>app的内容顶到最上面了，即状态栏遮挡一部分界面。</p>
<p>这是因为，把状态栏掩藏掉，那部分高度被app顶上去了，如何解决？，我们只需要在布局文件中，这里以toolbar为例，设置android：fitsSystemWindows=”true” 。</p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_title_yes.png" alt="image"></p>
<p>解决。</p>
<p>fitsSystemWindows这是什么意思呢？，他的意思是说，让view可以根据系统窗口(如statusBar)来调整自己的布局，如果值为true,就会调整view的paingding属性来给systemWindows留出空间。</p>
<p>我们看看第二个解决办法。</p>
<h4 id="解决方法二："><a href="#解决方法二：" class="headerlink" title="解决方法二："></a>解决方法二：</h4><p>系统文件的状态栏高度在sdk\platforms\android-23\data\res\values\demins.xml中我们可以找到系统文件中的状态栏高度。</p>
<pre><code>&lt;!-- Height of the status bar --&gt;


&lt;dimen name=&quot;status_bar_height&quot;&gt;24dp&lt;/dimen&gt;

&lt;!-- Height of the bottom navigation / system bar. --&gt;


&lt;dimen name=&quot;navigation_bar_height&quot;&gt;48dp&lt;/dimen
</code></pre><p>默认为24dp，当然不同的手机厂商可能高度不一样，我们不能写死，需要动态获取这个值。</p>
<p>这里有两种思路，一个是反射，一个是通过getResources.getIdentifier()。</p>
<p>这里都写一遍出来。</p>
<h4 id="通过反射"><a href="#通过反射" class="headerlink" title="通过反射"></a>通过反射</h4><pre><code>public int getStatusBarHeight(){
    int statusHeight=-1;
try {
            Class&lt;?&gt; aClass = Class.forName(&quot;com.android.internal.R$dimen&quot;);
            Object o = aClass.newInstance();
            Field status_bar_height = aClass.getField(&quot;status_bar_height&quot;);
            int statusBarHeightId = (int) status_bar_height.get(o);
//          获取的其实是资源id 需要转换成px
            statusHeight = getResources().getDimensionPixelSize(statusBarHeightId);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    return statusHeight==-1?dp2px(24):statusHeight;
    }
</code></pre><h4 id="通过getResources-getIdentifier"><a href="#通过getResources-getIdentifier" class="headerlink" title="通过getResources.getIdentifier()"></a>通过getResources.getIdentifier()</h4><pre><code> public int getStatusBarHeight(){

        int statusBarId = getResources().getIdentifier(&quot;status_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);
        int statusBarHeight=-1;
        if(statusBarId&gt;0){
             statusBarHeight = getResources().getDimensionPixelSize(statusBarId);
        }
        //代码默认为24dp
        return statusBarHeight==-1?dp2px(24):statusBarHeight;
    }
</code></pre><p>获取到状态栏的高度之后，我们是不是可以把Toolbar的高度增加相同的高度，app顶到状态的问题不就可以轻松解决了。</p>
<pre><code>  ViewGroup.LayoutParams params = toolbar.getLayoutParams();
   params.height+=getStatusBarHeight();
   titleBar.setLayoutParams(params);
   titleBar.setPadding(toolbar.getPaddingLeft(),
                       toolbar.getPaddingRight(),
                       toolbar.getPaddingTop()+getStatusBarHeight(),
                       toolbar.getPaddingBottom()
                     );
</code></pre><h2 id="接着，4-4版本的导航条"><a href="#接着，4-4版本的导航条" class="headerlink" title="接着，4.4版本的导航条"></a>接着，4.4版本的导航条</h2><p>1、显示导航条，并且自定义颜色。</p>
<p>因为4.4并没有提供对应的方法，这里的思路是，让它透明，然后再布局中写一个高度一样的view，置底，重合navigationBar的位置。</p>
<p>首先，计算navigationBar的高度，这个和状态栏statusBar是一样的。</p>
<h4 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h4><pre><code>public int getNavigationBarHeight(){
    int navigationHeight=-1;
try {
            Class&lt;?&gt; aClass = Class.forName(&quot;com.android.internal.R$dimen&quot;);
            Object o = aClass.newInstance();
            Field status_bar_height = aClass.getField(&quot;navigation_bar_height&quot;);
            int statusBarHeightId = (int) status_bar_height.get(o);
//          获取的其实是资源id 需要转换成px
            navigationHeight = getResources().getDimensionPixelSize(statusBarHeightId);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    return navigationHeight==-1?dp2px(24):navigationHeight;
    }
</code></pre><h4 id="getResources-getIdentifier"><a href="#getResources-getIdentifier" class="headerlink" title="getResources.getIdentifier()"></a>getResources.getIdentifier()</h4><pre><code>    //获取底部的导航条的高度
    public int getNavigationBarHeight(){
        int navigationId = getResources().getIdentifier(&quot;navigation_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);
        int navigationBaHeight=-1;
        if(navigationId&gt;0){
            navigationBaHeight = getResources().getDimensionPixelSize(navigationId);
        }
        //代码默认为48dp
        return navigationBaHeight==-1?dp2px(48):navigationBaHeight;
    }
</code></pre><p>我们的xml布局</p>
<pre><code>
&lt;RelativeLayout 
    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;
    android:id=&quot;@+id/activity_main&quot;
    android:orientation=&quot;vertical&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    &gt;

   &lt;android.support.v7.widget.Toolbar
       android:id=&quot;@+id/toolbar&quot;
       android:fitsSystemWindows=&quot;true&quot;
       android:layout_width=&quot;match_parent&quot;
       android:layout_height=&quot;?actionBarSize&quot;
       app:title=&quot;测试&quot;
       app:titleTextColor=&quot;#fff&quot;
       android:background=&quot;@color/colorAccent&quot;
       &gt;&lt;/android.support.v7.widget.Toolbar&gt;

   &lt;View
       android:layout_alignParentBottom=&quot;true&quot;
       android:id=&quot;@+id/nivagtion&quot;
       android:layout_width=&quot;match_parent&quot;
       android:layout_height=&quot;0dp&quot;/&gt;
&lt;/RelativeLayout&gt;
</code></pre><p>View是关键，这里我们把它置底，并且让他的高度尽可能的小，接着我们重设他的高度</p>
<pre><code>View nivagtionBar = findViewById(R.id.nivagtion);
nivagtionBar.getLayoutParams();

  ViewGroup.LayoutParams bootomParams = nivagtionBar.getLayoutParams();
  //这里需要 判断是否存在，不存在，4.4设置会报错，同时，设置nivagtionBar的高度为0
        if(isBootomBarShow()){
            bootomParams.height+=getNavigationBarHeight();
            bootomBar.setBackgroundColor(primaryColor);
            bootomBar.setLayoutParams(bootomParams);
        }else{
            bootomParams.height=0;
            nivagtionBar.setLayoutParams(bootomParams);
         }
</code></pre><pre><code> //判断是否打开底部导航条 5.1以上没有导航栏也可以设置颜色。
    public    boolean isBootomBarShow(){
        Display display = getWindowManager().getDefaultDisplay();
        DisplayMetrics outMetrics=new DisplayMetrics();
        //获取整个屏幕的高度
        display.getRealMetrics(outMetrics);
        int realHeight = outMetrics.heightPixels;
        int realWidth = outMetrics.widthPixels;
        //获取内容展示的高度
        outMetrics=new DisplayMetrics();
        display.getMetrics(outMetrics);
        int contentHeight = outMetrics.heightPixels;
        int contentWidth = outMetrics.widthPixels;

        int h = realHeight - contentHeight;
        int w = realWidth - contentWidth;

        return h&gt;0||w&gt;0;//竖屏情况和横屏情况。
    }
</code></pre><p>上效果图：</p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_navigation.png" alt="image"></p>
<p>2、不显示导航条。</p>
<p>这个比较简单，直接上代码，这是一个可以藏显示导航条的开关方法。</p>
<pre><code> public void toggleHideyBar() {

        int uiOptions = getWindow().getDecorView().getSystemUiVisibility();
        int newUiOptions = uiOptions;
        boolean isImmersiveModeEnabled =
                ((uiOptions | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY) == uiOptions);
        if (isImmersiveModeEnabled) {
            Log.d(TAG,&quot;打开&quot;);
        } else {
            Log.d(TAG,&quot;关闭&quot;);
        }

        if (Build.VERSION.SDK_INT &gt;= 14) {
            newUiOptions ^= View.SYSTEM_UI_FLAG_HIDE_NAVIGATION;
        }

        if (Build.VERSION.SDK_INT &gt;= 16) {
            newUiOptions ^= View.SYSTEM_UI_FLAG_FULLSCREEN;
        }

        if (Build.VERSION.SDK_INT &gt;= 18) {
            newUiOptions ^= View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;
        }

        getWindow().getDecorView().setSystemUiVisibility(newUiOptions);
    }
</code></pre><p>效果图：</p>
<p><img src="http://livesunhexo.oss-cn-shanghai.aliyuncs.com/hexo/steep_toggel2.gif" alt="image"></p>
<p>稍后我会把代码封装好的上传到github。</p>
<p>github已更新，地址：<a href="https://github.com/livesun/translucent" target="_blank" rel="external">https://github.com/livesun/translucent</a></p>
<h2 id="比较凌乱的代码分享"><a href="#比较凌乱的代码分享" class="headerlink" title="比较凌乱的代码分享:"></a>比较凌乱的代码分享:</h2><pre><code>public class BaseTranslucentActivity extends AppCompatActivity {



    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        //判断当前版本如果大于4.4 并且小于5.0
        if(Build.VERSION.SDK_INT&gt;=Build.VERSION_CODES.KITKAT
                &amp;&amp;Build.VERSION.SDK_INT&lt;Build.VERSION_CODES.LOLLIPOP
                ){
            //设置状态栏透明
            getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);
            //设置导航栏透明
            getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_NAVIGATION);
        }
    }

    /**
     *
     * @param titleBar 顶布局
     * @param bootomBar 导航条
     * @param primaryColor 背景颜色
     * @param resId 图片
     */
    public void setOrChangeTranslucentColor(View titleBar,@Nullable View bootomBar,int primaryColor,int resId){
        if(Build.VERSION.SDK_INT&gt;=Build.VERSION_CODES.KITKAT
                &amp;&amp;Build.VERSION.SDK_INT&lt;Build.VERSION_CODES.LOLLIPOP
                ){
            //顶部
                if(titleBar!=null){
                    ViewGroup.LayoutParams params = titleBar.getLayoutParams();
                    params.height+=getStatusBarHeight();
                    titleBar.setLayoutParams(params);
                    titleBar.setPadding(titleBar.getPaddingLeft(),
                                        titleBar.getPaddingRight(),
                                        titleBar.getPaddingTop()+getStatusBarHeight(),
                                        titleBar.getPaddingBottom()
                                        );
                    if(primaryColor!=Color.TRANSPARENT){
                        titleBar.setBackgroundColor(primaryColor);
                    }else{
                        titleBar.setBackground(getResources().getDrawable(resId));
                    }


                }
            //底部
                if(bootomBar!=null){
                    ViewGroup.LayoutParams bootomParams = bootomBar.getLayoutParams();
                    if(isBootomBarShow()){
                        bootomParams.height+=getNavigationBarHeight();
                        bootomBar.setBackgroundColor(primaryColor);
                        bootomBar.setLayoutParams(bootomParams);
                    }else{
                        bootomParams.height=0;
                        bootomBar.setLayoutParams(bootomParams);
                    }
                }
            toggleHideyBar();
            //5.0
        }else if(Build.VERSION.SDK_INT&gt;=Build.VERSION_CODES.LOLLIPOP){
            //如果颜色为透明，则用图片
            if(primaryColor== Color.TRANSPARENT){
                View decorView = getWindow().getDecorView();
                int option = View.SYSTEM_UI_FLAG_LAYOUT_FULLSCREEN
                        | View.SYSTEM_UI_FLAG_LAYOUT_STABLE;
                decorView.setSystemUiVisibility(option);

                ViewGroup.LayoutParams params = titleBar.getLayoutParams();
                params.height+=getStatusBarHeight();
                titleBar.setLayoutParams(params);
                titleBar.setPadding(titleBar.getPaddingLeft(),
                        titleBar.getPaddingRight(),
                        titleBar.getPaddingTop()+getStatusBarHeight(),
                        titleBar.getPaddingBottom()
                );
            }
            if(bootomBar!=null){
                getWindow().setNavigationBarColor(primaryColor);
            }
            getWindow().setStatusBarColor(primaryColor);
            toggleHideyBar();
        }
    }

    //获取顶部状态栏的高度
    public int getStatusBarHeight(){
        int statusBarId = getResources().getIdentifier(&quot;status_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);
        int statusBarHeight=-1;
        if(statusBarId&gt;0){
             statusBarHeight = getResources().getDimensionPixelSize(statusBarId);
        }
        //代码默认为24dp
        return statusBarHeight==-1?dp2px(24):statusBarHeight;
    }

    //获取底部的导航条的高度
    public int getNavigationBarHeight(){
        int navigationId = getResources().getIdentifier(&quot;navigation_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);
        int navigationBaHeight=-1;
        if(navigationId&gt;0){
            navigationBaHeight = getResources().getDimensionPixelSize(navigationId);
        }
        //代码默认为48dp
        return navigationBaHeight==-1?dp2px(48):navigationBaHeight;
    }

    //判断是否打开底部导航条 5.1以上没有导航栏也可以设置颜色。
    public    boolean isBootomBarShow(){
        Display display = getWindowManager().getDefaultDisplay();
        DisplayMetrics outMetrics=new DisplayMetrics();
        //获取整个屏幕的高度
        display.getRealMetrics(outMetrics);
        int realHeight = outMetrics.heightPixels;
        int realWidth = outMetrics.widthPixels;
        //获取内容展示的高度
        outMetrics=new DisplayMetrics();
        display.getMetrics(outMetrics);
        int contentHeight = outMetrics.heightPixels;
        int contentWidth = outMetrics.widthPixels;

        int h = realHeight - contentHeight;
        int w = realWidth - contentWidth;

        return h&gt;0||w&gt;0;//竖屏情况和横屏情况。
    }


    private int dp2px(int dp) {
        return (int) TypedValue.applyDimension(TypedValue.COMPLEX_UNIT_DIP,dp,getResources().getDisplayMetrics());
    }

    public void toggleHideyBar() {

        int uiOptions = getWindow().getDecorView().getSystemUiVisibility();
        int newUiOptions = uiOptions;
        boolean isImmersiveModeEnabled =
                ((uiOptions | View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY) == uiOptions);
        if (isImmersiveModeEnabled) {

        } else {
        }

        if (Build.VERSION.SDK_INT &gt;= 14) {
            newUiOptions ^= View.SYSTEM_UI_FLAG_HIDE_NAVIGATION;
        }

        if (Build.VERSION.SDK_INT &gt;= 16) {
            newUiOptions ^= View.SYSTEM_UI_FLAG_FULLSCREEN;
        }

        if (Build.VERSION.SDK_INT &gt;= 18) {
            newUiOptions ^= View.SYSTEM_UI_FLAG_IMMERSIVE_STICKY;
        }

        getWindow().getDecorView().setSystemUiVisibility(newUiOptions);
    }

}
</code></pre>
    

    
</div>


                

                <!-- Post Comments -->
                
                    







                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/06/19/cunstom_drawable/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/06/14/clippaading/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="孙俊卿's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        290287491@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto: 290287491@qq.com" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/" target="_self">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/06/">六月 2017<span class="sidebar_archives-count">9</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/Android架构/">Android架构<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/常用控件/">常用控件<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/源码分析/">源码分析<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/自定义View/">自定义View<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/自定义view/">自定义view<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/categories/设计模式/">设计模式<span class="sidebar_archives-count">4</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;
            <script type="text/javascript">
                var fd = new Date();
                document.write(fd.getFullYear());
            </script>
            &nbsp;我的博客
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import File -->

    <script src="/js/lazyload.min.js"></script>
    <script src="/js/js.min.js"></script>



    <script src="/js/nprogress.js"></script>


<script type="text/javascript">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>
















<!-- Window Load-->
<script>
    $(window).load(function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });
</script>

<!-- MathJax Load-->

<script>
    <!-- Offer LazyLoad -->
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    <!-- Start Queue -->
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

                </main>
            </div>
        </body>
    
</html>
